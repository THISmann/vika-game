version: "3.8"
services:
  auth:
    build: ./node/auth-service
    volumes:
      - ./node/auth-service/data:/app/data
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=development
      - PORT=3001

  quiz:
    build: ./node/quiz-service
    volumes:
      - ./node/quiz-service/data:/app/data
    ports:
      - "3002:3002"
    environment:
      - NODE_ENV=development
      - PORT=3002

  game:
    build: ./node/game-service
    volumes:
      - ./node/game-service/data:/app/data
    ports:
      - "3003:3003"
    environment:
      - NODE_ENV=development
      - PORT=3003
      - AUTH_SERVICE_URL=http://auth:3001
      - QUIZ_SERVICE_URL=http://quiz:3002

  telegram-bot:
    build: ./node/telegram-bot
    ports:
      - "3004:3004"
    depends_on:
      - auth
      - quiz
      - game
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - AUTH_SERVICE_URL=http://auth:3001
      - QUIZ_SERVICE_URL=http://quiz:3002
      - GAME_SERVICE_URL=http://game:3003
      - GAME_WS_URL=http://game:3003
    env_file:
      - ./node/telegram-bot/.env

  frontend:
    build: ./vue
    ports:
      - "5173:5173"
    depends_on:
      - auth
      - quiz
      - game
    environment:
      - VITE_AUTH_SERVICE_URL=http://localhost:3001
      - VITE_QUIZ_SERVICE_URL=http://localhost:3002
      - VITE_GAME_SERVICE_URL=http://localhost:3003